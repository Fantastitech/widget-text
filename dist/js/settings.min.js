var RiseVision=RiseVision||{};RiseVision.Text={},RiseVision.Text.Settings={},RiseVision.Text.Settings=function(t,o){"use strict";function e(){var e=null,n={},s=d.composer.doc.body.getAttribute("data-background-color");t(".errors").empty(),n["background-color"]=s,n.data=m.val(),e={params:null,additionalParams:JSON.stringify(n)},t(".alert").hide(),o.rpc.call("","rscmd_saveSettings",null,e)}function n(){t("#save").on("click",function(){e()}),t("#cancel, .close, .widget-overlay").on("click",function(){o.rpc.call("","rscmd_closeSettings",null)}),t("#help").on("click",function(){window.open(h,"_blank")}),t(".wysihtml5-sandbox").contents().find("body").on("click",function(){var t="",o="",e="",n="",s=null,m=null;c.spectrum("hide"),r.spectrum("hide"),l.spectrum("hide"),s=d.composer.selection.getSelectedNode(),s&&3===s.nodeType&&(m=s.parentNode,m&&1===m.nodeType&&"body"!==m.tagName.toLowerCase()&&(t=window.getComputedStyle(m,null).getPropertyValue("font-family"),o=window.getComputedStyle(m,null).getPropertyValue("font-size"),e=window.getComputedStyle(m,null).getPropertyValue("color"),n=window.getComputedStyle(m,null).getPropertyValue("background-color"),t&&i.data("plugin_fontPicker").setFont(t),o&&a.data("plugin_fontSizePicker").setFontSize(o),e&&c.spectrum("set",e),n&&r.spectrum("set",n)))})}function s(){m.wysihtml5({"font-styles":!1,lists:!1,link:!1,image:!1,stylesheets:[u,p,g]}),d=m.data("wysihtml5").editor,i=t(".font-picker"),a=t(".font-size-picker"),c=t("#text-color"),r=t("#highlight-color"),l=t("#background-color"),n(),t(".alert").hide(),o.rpc.call("","rscmd_getAdditionalParams",function(e){var n,s,a,c,r,m,u=(new o.Prefs,RiseVision.Common.Utilities);e&&(e=JSON.parse(e),d.setValue(e.data),m=e["background-color"],m&&(l.spectrum("set",m),d.composer.commands.exec("backgroundColor",m,[{name:"data-background-color",value:m}])),t.each(t(e.data).find("span").andSelf(),function(){n=t(this).attr("data-standard-font"),s=t(this).attr("data-google-font"),a=t(this).attr("data-custom-font"),c=t(this).attr("data-text-color"),r=t(this).attr("data-highlight-color"),n&&d.composer.commands.exec("standardFont",n,t(this).attr("data-standard-font-family")),s&&(i.data("plugin_fontPicker").addGoogleFont(s,!1),d.composer.commands.exec("googleFont",s)),a&&(u.loadCustomFont(a,t(this).attr("data-custom-font-url"),d.composer.iframe.contentDocument),d.composer.commands.exec("customFont",a,t(this).attr("data-custom-font-url"))),c&&d.composer.commands.exec("textColor",c),r&&d.composer.commands.exec("highlightColor",r)})),i18n.init(function(){t(".widget-wrapper").i18n().show(),t(".buttons").sticky({container:t("#wrapper"),topSpacing:41})})})}var i,a,c,r,l,d=null,m=t("#editable"),u="components/bootstrap-form-components/dist/css/all.css",p="components/rv-bootstrap3-wysihtml5/dist/css/bootstrap3-wysihtml5-line-height.min.css",g="components/style-guide/dist/css/alignment.min.css",h="http://www.risevision.com/help/users/what-are-gadgets/content/playlist-item-text-editor/";return{init:s}}($,gadgets);