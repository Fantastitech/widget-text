!function(t,e,n,o){"use strict";function i(e,n){this.element=e,this.page=t(e).find(".page"),this.options=t.extend({},a,n),this._defaults=a,this._name=s,this.init()}var s="autoScroll",a={by:"continuous",speed:"medium",pause:5},l=!0,r=null,c=null,u=null;i.prototype={init:function(){var e,n,i=this,s=null,a=null,l=null,p=t(this.element).outerHeight(!0),d=p,f=this.element.scrollHeight-this.element.offsetHeight;this.canScroll()&&("page"===this.options.by?(e="fastest"===this.options.speed?.4:"fast"===this.options.speed?.8:"medium"===this.options.speed?1.2:"slow"===this.options.speed?1.6:2,n=this.page.outerHeight(!0)/t(this.element).outerHeight(!0)*e):(e="fastest"===this.options.speed?60:"fast"===this.options.speed?50:"medium"===this.options.speed?40:"slow"===this.options.speed?30:20,n=Math.abs((this.page.outerHeight(!0)-t(this.element).outerHeight(!0))/e)),Draggable.create(this.element,{type:"scrollTop",throwProps:!0,edgeResistance:.75,onPress:function(){c.pause(),TweenLite.killDelayedCallsTo(s),TweenLite.killDelayedCallsTo(a),TweenLite.killDelayedCallsTo(u),TweenLite.killDelayedCallsTo(l)},onRelease:function(){"none"!==i.options.by&&TweenLite.delayedCall(i.options.pause,s=function(){d=t(i.element).scrollTop()+p,c.progress(t(i.element).scrollTop()/f).play()})}}),r=Draggable.get(this.element),c=TweenLite.to(r.scrollProxy,n,{scrollTop:f,ease:Linear.easeNone,delay:this.options.pause,paused:!0,onUpdate:"page"===this.options.by?function(){Math.abs(r.scrollProxy.top())>=d&&(c.pause(),d+=p,TweenLite.delayedCall(i.options.pause,l=function(){c.resume()}))}:o,onComplete:function(){TweenLite.delayedCall(i.options.pause,a=function(){TweenLite.to(i.page,1,{autoAlpha:0,onComplete:function(){c.seek(0).pause(),"page"===i.options.by&&(d=p),t(i.element).trigger("done")}})})}}),TweenLite.set(this.element,{overflowY:"hidden"}))},canScroll:function(){return this.options&&this.page.height()>t(this.element).height()}},i.prototype.play=function(){this.canScroll()&&"none"!==this.options.by&&c&&(l?(c.play(),l=!1):(TweenLite.to(this.page,1,{autoAlpha:1}),TweenLite.delayedCall(this.options.pause,u=function(){c.play()})))},i.prototype.pause=function(){c&&c.pause()},i.prototype.stop=function(){c&&c.kill(),this.element=null,this.page=null},t.fn.autoScroll=function(e){return this.each(function(){t.data(this,"plugin_"+s)||t.data(this,"plugin_"+s,new i(this,e))})}}(jQuery,window,document);var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{},RiseVision.Common.Utilities=function(){function t(t,e){var n="font-family:"+e.font.family+"; ",o="color: "+e.color+"; ",i="font-size: "+e.size+"px; ",s="font-weight: "+(e.bold?"bold":"normal")+"; ",a="font-style: "+(e.italic?"italic":"normal")+"; ",l="text-decoration: "+(e.underline?"underline":"none")+"; ",r="background-color: "+e.highlightColor+"; ";return"."+t+" {"+n+o+i+s+a+l+r+"}"}function e(t){for(var e=document.createElement("style"),n=0,o=t.length;o>n;n++)e.appendChild(document.createTextNode(t[n]));document.head.appendChild(e)}function n(n,s){n.forEach(function(n){n.class&&n.fontSetting&&e([t(n.class,n.fontSetting)]),n.fontSetting.font.type&&("custom"===n.fontSetting.font.type&&n.fontSetting.font.family&&n.fontSetting.font.url?o(n.fontSetting.font.family,n.fontSetting.font.url,s):"google"===n.fontSetting.font.type&&n.fontSetting.font.family&&i(n.fontSetting.font.family,s))})}function o(t,e,n){var o=null,i="font-family: "+t+"; src: url('"+e+"');";n=n||document,o=n.styleSheets[0],null!==o&&o.addRule("@font-face",i)}function i(t,e){var n=document.createElement("link");e=e||document,n.setAttribute("rel","stylesheet"),n.setAttribute("type","text/css"),n.setAttribute("href","https://fonts.googleapis.com/css?family="+t),null!==n&&e.getElementsByTagName("head")[0].appendChild(n)}function s(t){for(var e=t.length,n=[],o=0;e>o;o++)n[o]=new Image,n[o].src=t[o]}return{getFontCssStyle:t,addCSSRules:e,loadFonts:n,loadCustomFont:o,loadGoogleFont:i,preloadImages:s}}();var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-57092159-13"]),_gaq.push(["_trackPageview"]),function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}();var RiseVision=RiseVision||{};RiseVision.Text={},RiseVision.Text=function(t){"use strict";function e(){t.rpc.call("","rsevent_ready",null,r.getString("id"),!0,!0,!0,!0,!0)}function n(){t.rpc.call("","rsevent_done",null,r.getString("id"))}function o(t,o){if("additionalParams"===t&&o){var s=JSON.parse(o),a=s.data,l=[];$("#container").height(r.getInt("rsH")).css("background-color",s.background||"transparent"),$(".page").width(r.getInt("rsW")).html(a),$.each($("<div/>").html(a).find("span").addBack(),function(){var t=$(this).attr("data-standard-font"),e=$(this).attr("data-google-font"),n=$(this).attr("data-custom-font"),o="",s="",a=[];t&&l.push(i(t)),e&&(c.loadGoogleFont(e),l.push(i(e))),n&&(c.loadCustomFont(n,$(this).attr("data-custom-font-url")),l.push(i(n))),a=this.className.split(" "),o=$(this).attr("data-text-color"),s=$(this).attr("data-highlight-color");for(var r=0,u=a.length;u>r;r++)0===a[r].indexOf("wysiwyg-text-color")?l.push("."+a[r]+" { color: "+o+"; }"):0===a[r].indexOf("wysiwyg-highlight-color")&&l.push("."+a[r]+" { background-color: "+s+"; }")}),c.addCSSRules(l),$("#container").autoScroll(s.scroll).on("done",function(){n()})}e()}function i(t){return".wysiwyg-font-family-"+t.replace(/ /g,"-").toLowerCase()+" { font-family: '"+t+"', serif; }"}function s(){$("#container").data("plugin_autoScroll").play()}function a(){$("#container").data("plugin_autoScroll").pause()}function l(){a()}var r=new t.Prefs,c=RiseVision.Common.Utilities;return{getAdditionalParams:o,play:s,pause:a,stop:l}}(gadgets),function(t,e){"use strict";function n(){RiseVision.Text.play()}function o(){RiseVision.Text.pause()}function i(){RiseVision.Text.stop()}var s=new e.Prefs,a=s.getString("id");a&&(e.rpc.register("rscmd_play_"+a,n),e.rpc.register("rscmd_pause_"+a,o),e.rpc.register("rscmd_stop_"+a,i),e.rpc.register("rsparam_set_"+a,RiseVision.Text.getAdditionalParams),e.rpc.call("","rsparam_get",null,a,"additionalParams")),t.oncontextmenu=function(){return!1}}(window,gadgets);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzL3dpZGdldC5taW4uanMiXSwibmFtZXMiOlsiJCIsIndpbmRvdyIsImRvY3VtZW50IiwidW5kZWZpbmVkIiwiUGx1Z2luIiwiZWxlbWVudCIsIm9wdGlvbnMiLCJ0aGlzIiwicGFnZSIsImZpbmQiLCJleHRlbmQiLCJkZWZhdWx0cyIsIl9kZWZhdWx0cyIsIl9uYW1lIiwicGx1Z2luTmFtZSIsImluaXQiLCJieSIsInNwZWVkIiwicGF1c2UiLCJpc0xvYWRpbmciLCJkcmFnZ2FibGUiLCJ0d2VlbiIsInJlc3VtZVR3ZWVuIiwicHJvdG90eXBlIiwiZHVyYXRpb24iLCJzZWxmIiwiY2FsY3VsYXRlUHJvZ3Jlc3MiLCJzY3JvbGxDb21wbGV0ZSIsInBhZ2VDb21wbGV0ZSIsImVsZW1lbnRIZWlnaHQiLCJvdXRlckhlaWdodCIsInBhdXNlSGVpZ2h0IiwibWF4Iiwic2Nyb2xsSGVpZ2h0Iiwib2Zmc2V0SGVpZ2h0IiwiY2FuU2Nyb2xsIiwiTWF0aCIsImFicyIsIkRyYWdnYWJsZSIsImNyZWF0ZSIsInR5cGUiLCJ0aHJvd1Byb3BzIiwiZWRnZVJlc2lzdGFuY2UiLCJvblByZXNzIiwiVHdlZW5MaXRlIiwia2lsbERlbGF5ZWRDYWxsc1RvIiwib25SZWxlYXNlIiwiZGVsYXllZENhbGwiLCJzY3JvbGxUb3AiLCJwcm9ncmVzcyIsInBsYXkiLCJnZXQiLCJ0byIsInNjcm9sbFByb3h5IiwiZWFzZSIsIkxpbmVhciIsImVhc2VOb25lIiwiZGVsYXkiLCJwYXVzZWQiLCJvblVwZGF0ZSIsInRvcCIsInJlc3VtZSIsIm9uQ29tcGxldGUiLCJhdXRvQWxwaGEiLCJzZWVrIiwidHJpZ2dlciIsInNldCIsIm92ZXJmbG93WSIsImhlaWdodCIsInN0b3AiLCJraWxsIiwiZm4iLCJhdXRvU2Nyb2xsIiwiZWFjaCIsImRhdGEiLCJqUXVlcnkiLCJSaXNlVmlzaW9uIiwiQ29tbW9uIiwiVXRpbGl0aWVzIiwiZ2V0Rm9udENzc1N0eWxlIiwiY2xhc3NOYW1lIiwiZm9udE9iaiIsImZhbWlseSIsImZvbnQiLCJjb2xvciIsInNpemUiLCJ3ZWlnaHQiLCJib2xkIiwiaXRhbGljIiwidW5kZXJsaW5lIiwiaGlnaGxpZ2h0IiwiaGlnaGxpZ2h0Q29sb3IiLCJhZGRDU1NSdWxlcyIsInJ1bGVzIiwic3R5bGUiLCJjcmVhdGVFbGVtZW50IiwiaSIsImxlbmd0aCIsImFwcGVuZENoaWxkIiwiY3JlYXRlVGV4dE5vZGUiLCJoZWFkIiwibG9hZEZvbnRzIiwic2V0dGluZ3MiLCJjb250ZW50RG9jIiwiZm9yRWFjaCIsIml0ZW0iLCJjbGFzcyIsImZvbnRTZXR0aW5nIiwidXJsIiwibG9hZEN1c3RvbUZvbnQiLCJsb2FkR29vZ2xlRm9udCIsInNoZWV0IiwicnVsZSIsInN0eWxlU2hlZXRzIiwiYWRkUnVsZSIsInN0eWxlc2hlZXQiLCJzZXRBdHRyaWJ1dGUiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsInByZWxvYWRJbWFnZXMiLCJ1cmxzIiwiaW1hZ2VzIiwiSW1hZ2UiLCJzcmMiLCJfZ2FxIiwicHVzaCIsImdhIiwiYXN5bmMiLCJsb2NhdGlvbiIsInByb3RvY29sIiwicyIsInBhcmVudE5vZGUiLCJpbnNlcnRCZWZvcmUiLCJUZXh0IiwiZ2FkZ2V0cyIsInJlYWR5IiwicnBjIiwiY2FsbCIsInByZWZzIiwiZ2V0U3RyaW5nIiwiZG9uZSIsImdldEFkZGl0aW9uYWxQYXJhbXMiLCJuYW1lIiwidmFsdWUiLCJwYXJhbXMiLCJKU09OIiwicGFyc2UiLCJnZXRJbnQiLCJjc3MiLCJiYWNrZ3JvdW5kIiwid2lkdGgiLCJodG1sIiwiYWRkQmFjayIsInN0YW5kYXJkRm9udCIsImF0dHIiLCJnb29nbGVGb250IiwiY3VzdG9tRm9udCIsInRleHRDb2xvciIsImNsYXNzZXMiLCJjcmVhdGVGb250UnVsZSIsInV0aWxzIiwic3BsaXQiLCJpbmRleE9mIiwic2Nyb2xsIiwib24iLCJyZXBsYWNlIiwidG9Mb3dlckNhc2UiLCJQcmVmcyIsImlkIiwicmVnaXN0ZXIiLCJvbmNvbnRleHRtZW51Il0sIm1hcHBpbmdzIjoiQ0FPQyxTQUFXQSxFQUFHQyxFQUFRQyxFQUFVQyxHQUNoQyxZQWFBLFNBQVNDLEdBQU9DLEVBQVNDLEdBQ3hCQyxLQUFLRixRQUFVQSxFQUNmRSxLQUFLQyxLQUFPUixFQUFFSyxHQUFTSSxLQUFLLFNBQzVCRixLQUFLRCxRQUFVTixFQUFFVSxVQUFXQyxFQUFVTCxHQUN0Q0MsS0FBS0ssVUFBWUQsRUFDakJKLEtBQUtNLE1BQVFDLEVBQ2JQLEtBQUtRLE9BakJOLEdBQUlELEdBQWEsYUFDaEJILEdBQ0NLLEdBQUksYUFDSkMsTUFBTyxTQUNQQyxNQUFPLEdBRVJDLEdBQVksRUFDWkMsRUFBWSxLQUNaQyxFQUFRLEtBQ1JDLEVBQWMsSUFXZmxCLEdBQU9tQixXQUNOUixLQUFNLFdBQ0wsR0FBSUUsR0FBT08sRUFDUEMsRUFBT2xCLEtBQ1BtQixFQUFvQixLQUNwQkMsRUFBaUIsS0FDakJDLEVBQWUsS0FDZkMsRUFBZ0I3QixFQUFFTyxLQUFLRixTQUFTeUIsYUFBWSxHQUM1Q0MsRUFBY0YsRUFDZEcsRUFBTXpCLEtBQUtGLFFBQVE0QixhQUFlMUIsS0FBS0YsUUFBUTZCLFlBRS9DM0IsTUFBSzRCLGNBRWdCLFNBQXBCNUIsS0FBS0QsUUFBUVUsSUFFZkMsRUFEMEIsWUFBdkJWLEtBQUtELFFBQVFXLE1BQ1IsR0FFdUIsU0FBdkJWLEtBQUtELFFBQVFXLE1BQ2IsR0FFdUIsV0FBdkJWLEtBQUtELFFBQVFXLE1BQ2IsSUFFdUIsU0FBdkJWLEtBQUtELFFBQVFXLE1BQ2IsSUFHQSxFQUdUTyxFQUFXakIsS0FBS0MsS0FBS3NCLGFBQVksR0FDaEM5QixFQUFFTyxLQUFLRixTQUFTeUIsYUFBWSxHQUFRYixJQUlwQ0EsRUFEMEIsWUFBdkJWLEtBQUtELFFBQVFXLE1BQ1IsR0FFdUIsU0FBdkJWLEtBQUtELFFBQVFXLE1BQ2IsR0FFdUIsV0FBdkJWLEtBQUtELFFBQVFXLE1BQ2IsR0FFdUIsU0FBdkJWLEtBQUtELFFBQVFXLE1BQ2IsR0FHQSxHQUdUTyxFQUFXWSxLQUFLQyxLQUFLOUIsS0FBS0MsS0FBS3NCLGFBQVksR0FDMUM5QixFQUFFTyxLQUFLRixTQUFTeUIsYUFBWSxJQUFTYixJQUd2Q3FCLFVBQVVDLE9BQU9oQyxLQUFLRixTQUNyQm1DLEtBQU0sWUFDTkMsWUFBWSxFQUNaQyxlQUFnQixJQUNoQkMsUUFBUyxXQUNSdEIsRUFBTUgsUUFFTjBCLFVBQVVDLG1CQUFtQm5CLEdBQzdCa0IsVUFBVUMsbUJBQW1CbEIsR0FDN0JpQixVQUFVQyxtQkFBbUJ2QixHQUU3QnNCLFVBQVVDLG1CQUFtQmpCLElBRTlCa0IsVUFBVyxXQUNjLFNBQXBCckIsRUFBS25CLFFBQVFVLElBS2hCNEIsVUFBVUcsWUFBWXRCLEVBQUtuQixRQUFRWSxNQUNsQ1EsRUFBb0IsV0FFbkJLLEVBQWMvQixFQUFFeUIsRUFBS3BCLFNBQVMyQyxZQUM5Qm5CLEVBRUFSLEVBQU00QixTQUFTakQsRUFBRXlCLEVBQUtwQixTQUFTMkMsWUFBY2hCLEdBQzNDa0IsWUFPUDlCLEVBQVlrQixVQUFVYSxJQUFJNUMsS0FBS0YsU0FFL0JnQixFQUFRdUIsVUFBVVEsR0FBR2hDLEVBQVVpQyxZQUFhN0IsR0FDM0N3QixVQUFXaEIsRUFDWHNCLEtBQU1DLE9BQU9DLFNBQ2JDLE1BQU9sRCxLQUFLRCxRQUFRWSxNQUNwQndDLFFBQVEsRUFDUkMsU0FBK0IsU0FBcEJwRCxLQUFLRCxRQUFRVSxHQUFnQixXQUNuQ29CLEtBQUtDLElBQUlqQixFQUFVaUMsWUFBWU8sUUFBVTdCLElBQzVDVixFQUFNSCxRQUdOYSxHQUFlRixFQUVmZSxVQUFVRyxZQUFZdEIsRUFBS25CLFFBQVFZLE1BQ2xDVSxFQUFlLFdBQ2RQLEVBQU13QyxhQUlOMUQsRUFDSjJELFdBQVksV0FDWGxCLFVBQVVHLFlBQVl0QixFQUFLbkIsUUFBUVksTUFDbENTLEVBQWlCLFdBQ2hCaUIsVUFBVVEsR0FBRzNCLEVBQUtqQixLQUFNLEdBQ3ZCdUQsVUFBVyxFQUNYRCxXQUFZLFdBQ1h6QyxFQUFNMkMsS0FBSyxHQUFHOUMsUUFFVSxTQUFwQk8sRUFBS25CLFFBQVFVLEtBQ2hCZSxFQUFjRixHQUdmN0IsRUFBRXlCLEVBQUtwQixTQUFTNEQsUUFBUSxnQkFTOUJyQixVQUFVc0IsSUFBSTNELEtBQUtGLFNBQVc4RCxVQUFXLGFBSTNDaEMsVUFBVyxXQUNWLE1BQU81QixNQUFLRCxTQUFZQyxLQUFLQyxLQUFLNEQsU0FBV3BFLEVBQUVPLEtBQUtGLFNBQVMrRCxXQUkvRGhFLEVBQU9tQixVQUFVMkIsS0FBTyxXQUNuQjNDLEtBQUs0QixhQUFtQyxTQUFwQjVCLEtBQUtELFFBQVFVLElBQ2hDSyxJQUNDRixHQUNIRSxFQUFNNkIsT0FDTi9CLEdBQVksSUFHWnlCLFVBQVVRLEdBQUc3QyxLQUFLQyxLQUFNLEdBQUl1RCxVQUFXLElBQ3ZDbkIsVUFBVUcsWUFBWXhDLEtBQUtELFFBQVFZLE1BQ2pDSSxFQUFjLFdBQ2ZELEVBQU02QixZQVFYOUMsRUFBT21CLFVBQVVMLE1BQVEsV0FDcEJHLEdBQ0hBLEVBQU1ILFNBSVJkLEVBQU9tQixVQUFVOEMsS0FBTyxXQUNuQmhELEdBQ0hBLEVBQU1pRCxPQUdQL0QsS0FBS0YsUUFBVSxLQUNmRSxLQUFLQyxLQUFPLE1BS2JSLEVBQUV1RSxHQUFHQyxXQUFhLFNBQVNsRSxHQUMxQixNQUFPQyxNQUFLa0UsS0FBSyxXQUNYekUsRUFBRTBFLEtBQUtuRSxLQUFNLFVBQVlPLElBQzdCZCxFQUFFMEUsS0FBS25FLEtBQU0sVUFBWU8sRUFBWSxHQUFJVixHQUFPRyxLQUFNRCxRQUl2RHFFLE9BQVExRSxPQUFRQyxTQUVuQixJQUFJMEUsWUFBYUEsY0FFakJBLFlBQVdDLE9BQVNELFdBQVdDLFdBRS9CRCxXQUFXQyxPQUFPQyxVQUFZLFdBRTVCLFFBQVNDLEdBQWdCQyxFQUFXQyxHQUNsQyxHQUFJQyxHQUFTLGVBQWlCRCxFQUFRRSxLQUFLRCxPQUFTLEtBQ2hERSxFQUFRLFVBQVlILEVBQVFHLE1BQVEsS0FDcENDLEVBQU8sY0FBZ0JKLEVBQVFJLEtBQU8sT0FDdENDLEVBQVMsaUJBQW1CTCxFQUFRTSxLQUFPLE9BQVMsVUFBWSxLQUNoRUMsRUFBUyxnQkFBa0JQLEVBQVFPLE9BQVMsU0FBVyxVQUFZLEtBQ25FQyxFQUFZLHFCQUF1QlIsRUFBUVEsVUFBWSxZQUFjLFFBQVUsS0FDL0VDLEVBQVkscUJBQXVCVCxFQUFRVSxlQUFpQixJQUVoRSxPQUFPLElBQU1YLEVBQVksS0FBT0UsRUFBU0UsRUFBUUMsRUFBT0MsRUFBU0UsRUFBU0MsRUFBWUMsRUFBWSxJQUdwRyxRQUFTRSxHQUFZQyxHQUduQixJQUFLLEdBRkRDLEdBQVE1RixTQUFTNkYsY0FBYyxTQUUxQkMsRUFBSSxFQUFHQyxFQUFTSixFQUFNSSxPQUFZQSxFQUFKRCxFQUFZQSxJQUNqREYsRUFBTUksWUFBWWhHLFNBQVNpRyxlQUFlTixFQUFNRyxJQUdsRDlGLFVBQVNrRyxLQUFLRixZQUFZSixHQThCNUIsUUFBU08sR0FBVUMsRUFBVUMsR0FDM0JELEVBQVNFLFFBQVEsU0FBU0MsR0FDcEJBLEVBQUtDLE9BQVNELEVBQUtFLGFBQ3JCZixHQUFjYixFQUFnQjBCLEVBQUtDLE1BQU9ELEVBQUtFLGVBRzdDRixFQUFLRSxZQUFZeEIsS0FBSzNDLE9BQ1csV0FBL0JpRSxFQUFLRSxZQUFZeEIsS0FBSzNDLE1BQXFCaUUsRUFBS0UsWUFBWXhCLEtBQUtELFFBQ25FdUIsRUFBS0UsWUFBWXhCLEtBQUt5QixJQUN0QkMsRUFBZUosRUFBS0UsWUFBWXhCLEtBQUtELE9BQVF1QixFQUFLRSxZQUFZeEIsS0FBS3lCLElBQ2pFTCxHQUVvQyxXQUEvQkUsRUFBS0UsWUFBWXhCLEtBQUszQyxNQUFxQmlFLEVBQUtFLFlBQVl4QixLQUFLRCxRQUN4RTRCLEVBQWVMLEVBQUtFLFlBQVl4QixLQUFLRCxPQUFRcUIsTUFNckQsUUFBU00sR0FBZTNCLEVBQVEwQixFQUFLTCxHQUNuQyxHQUFJUSxHQUFRLEtBQ1JDLEVBQU8sZ0JBQWtCOUIsRUFBUyxlQUFzQjBCLEVBQU0sS0FFbEVMLEdBQWFBLEdBQWNyRyxTQUUzQjZHLEVBQVFSLEVBQVdVLFlBQVksR0FFakIsT0FBVkYsR0FDRkEsRUFBTUcsUUFBUSxhQUFjRixHQUloQyxRQUFTRixHQUFlNUIsRUFBUXFCLEdBQzlCLEdBQUlZLEdBQWFqSCxTQUFTNkYsY0FBYyxPQUV4Q1EsR0FBYUEsR0FBY3JHLFNBRTNCaUgsRUFBV0MsYUFBYSxNQUFPLGNBQy9CRCxFQUFXQyxhQUFhLE9BQVEsWUFDaENELEVBQVdDLGFBQWEsT0FBUSwyQ0FDOUJsQyxHQUVpQixPQUFmaUMsR0FDRlosRUFBV2MscUJBQXFCLFFBQVEsR0FBR25CLFlBQVlpQixHQUkzRCxRQUFTRyxHQUFjQyxHQUlyQixJQUFLLEdBSER0QixHQUFTc0IsRUFBS3RCLE9BQ2hCdUIsS0FFT3hCLEVBQUksRUFBT0MsRUFBSkQsRUFBWUEsSUFDMUJ3QixFQUFPeEIsR0FBSyxHQUFJeUIsT0FDaEJELEVBQU94QixHQUFHMEIsSUFBTUgsRUFBS3ZCLEdBSXpCLE9BQ0VqQixnQkFBa0JBLEVBQ2xCYSxZQUFrQkEsRUFDbEJTLFVBQWtCQSxFQUNsQlEsZUFBa0JBLEVBQ2xCQyxlQUFrQkEsRUFDbEJRLGNBQWtCQSxLQUt0QixJQUFJSyxNQUFPQSxRQUVYQSxNQUFLQyxNQUFNLGNBQWUsbUJBQzFCRCxLQUFLQyxNQUFNLG1CQUVYLFdBQ0UsR0FBSUMsR0FBSzNILFNBQVM2RixjQUFjLFNBQVc4QixHQUFHckYsS0FBTyxrQkFBbUJxRixFQUFHQyxPQUFRLEVBQ25GRCxFQUFHSCxLQUFPLFVBQVl4SCxTQUFTNkgsU0FBU0MsU0FBVyxjQUFnQixjQUFnQiw2QkFDbkYsSUFBSUMsR0FBSS9ILFNBQVNtSCxxQkFBcUIsVUFBVSxFQUFJWSxHQUFFQyxXQUFXQyxhQUFhTixFQUFJSSxLQU1wRixJQUFJckQsWUFBYUEsY0FDakJBLFlBQVd3RCxRQUVYeEQsV0FBV3dELEtBQU8sU0FBVUMsR0FDMUIsWUFRQSxTQUFTQyxLQUNQRCxFQUFRRSxJQUFJQyxLQUFLLEdBQUksZ0JBQWlCLEtBQU1DLEVBQU1DLFVBQVUsT0FBTyxHQUNqRSxHQUFNLEdBQU0sR0FBTSxHQUd0QixRQUFTQyxLQUNQTixFQUFRRSxJQUFJQyxLQUFLLEdBQUksZUFBZ0IsS0FBTUMsRUFBTUMsVUFBVSxPQU03RCxRQUFTRSxHQUFvQkMsRUFBTUMsR0FDakMsR0FBYSxxQkFBVEQsR0FBK0JDLEVBQU8sQ0FDeEMsR0FBSUMsR0FBU0MsS0FBS0MsTUFBTUgsR0FDcEJwRSxFQUFPcUUsRUFBT3JFLEtBQ2RtQixJQUdKN0YsR0FBRSxjQUFjb0UsT0FBT3FFLEVBQU1TLE9BQU8sUUFDakNDLElBQUksbUJBQW9CSixFQUFPSyxZQUFjLGVBQ2hEcEosRUFBRSxTQUFTcUosTUFBTVosRUFBTVMsT0FBTyxRQUFRSSxLQUFLNUUsR0FFM0MxRSxFQUFFeUUsS0FBS3pFLEVBQUUsVUFBVXNKLEtBQUs1RSxHQUFNakUsS0FBSyxRQUFROEksVUFBVyxXQUNwRCxHQUFJQyxHQUFleEosRUFBRU8sTUFBTWtKLEtBQUssc0JBQzVCQyxFQUFhMUosRUFBRU8sTUFBTWtKLEtBQUssb0JBQzFCRSxFQUFhM0osRUFBRU8sTUFBTWtKLEtBQUssb0JBQzFCRyxFQUFZLEdBQUlqRSxFQUFpQixHQUNqQ2tFLElBR0FMLElBQ0YzRCxFQUFNK0IsS0FBS2tDLEVBQWVOLElBSXhCRSxJQUNGSyxFQUFNakQsZUFBZTRDLEdBR3JCN0QsRUFBTStCLEtBQUtrQyxFQUFlSixLQUl4QkMsSUFDRkksRUFBTWxELGVBQWU4QyxFQUFZM0osRUFBRU8sTUFBTWtKLEtBQUsseUJBRzlDNUQsRUFBTStCLEtBQUtrQyxFQUFlSCxLQUk1QkUsRUFBVXRKLEtBQUt5RSxVQUFVZ0YsTUFBTSxLQUMvQkosRUFBWTVKLEVBQUVPLE1BQU1rSixLQUFLLG1CQUN6QjlELEVBQWlCM0YsRUFBRU8sTUFBTWtKLEtBQUssdUJBSTlCLEtBQUssR0FBSXpELEdBQUksRUFBR0MsRUFBUzRELEVBQVE1RCxPQUFZQSxFQUFKRCxFQUFZQSxJQUNGLElBQTdDNkQsRUFBUTdELEdBQUdpRSxRQUFRLHNCQUNyQnBFLEVBQU0rQixLQUFLLElBQU1pQyxFQUFRN0QsR0FBSyxhQUFlNEQsRUFBWSxPQUVBLElBQWxEQyxFQUFRN0QsR0FBR2lFLFFBQVEsNEJBQzFCcEUsRUFBTStCLEtBQUssSUFBTWlDLEVBQVE3RCxHQUFLLHdCQUM1QkwsRUFBaUIsU0FLekJvRSxFQUFNbkUsWUFBWUMsR0FFbEI3RixFQUFFLGNBQWN3RSxXQUFXdUUsRUFBT21CLFFBQ2pDQyxHQUFHLE9BQVEsV0FDVnhCLE1BSUpMLElBR0YsUUFBU3dCLEdBQWUzRSxHQUN0QixNQUFPLHdCQUEwQkEsRUFBS2lGLFFBQVEsS0FBTSxLQUFLQyxjQUN2RCxvQkFBc0JsRixFQUFPLGNBR2pDLFFBQVNqQyxLQUNQbEQsRUFBRSxjQUFjMEUsS0FBSyxxQkFBcUJ4QixPQUc1QyxRQUFTaEMsS0FDUGxCLEVBQUUsY0FBYzBFLEtBQUsscUJBQXFCeEQsUUFHNUMsUUFBU21ELEtBQ1BuRCxJQXBHRixHQUFJdUgsR0FBUSxHQUFJSixHQUFRaUMsTUFDcEJQLEVBQVFuRixXQUFXQyxPQUFPQyxTQXNHOUIsUUFDRThELG9CQUFxQkEsRUFDckIxRixLQUFxQkEsRUFDckJoQyxNQUFxQkEsRUFDckJtRCxLQUFxQkEsSUFFdEJnRSxTQUlILFNBQVdwSSxFQUFRb0ksR0FDakIsWUFLQSxTQUFTbkYsS0FDUDBCLFdBQVd3RCxLQUFLbEYsT0FHbEIsUUFBU2hDLEtBQ1AwRCxXQUFXd0QsS0FBS2xILFFBR2xCLFFBQVNtRCxLQUNQTyxXQUFXd0QsS0FBSy9ELE9BWmxCLEdBQUlvRSxHQUFRLEdBQUlKLEdBQVFpQyxNQUNwQkMsRUFBSzlCLEVBQU1DLFVBQVUsS0FlckI2QixLQUNGbEMsRUFBUUUsSUFBSWlDLFNBQVMsY0FBZ0JELEVBQUlySCxHQUN6Q21GLEVBQVFFLElBQUlpQyxTQUFTLGVBQWlCRCxFQUFJckosR0FDMUNtSCxFQUFRRSxJQUFJaUMsU0FBUyxjQUFnQkQsRUFBSWxHLEdBRXpDZ0UsRUFBUUUsSUFBSWlDLFNBQVMsZUFBaUJELEVBQUkzRixXQUFXd0QsS0FBS1EscUJBQzFEUCxFQUFRRSxJQUFJQyxLQUFLLEdBQUksY0FBZSxLQUFNK0IsRUFBSSxxQkFHaER0SyxFQUFPd0ssY0FBZ0IsV0FDckIsT0FBTyxJQUVSeEssT0FBUW9JIiwiZmlsZSI6ImpzL3dpZGdldC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogIFByb2plY3Q6IEF1dG8tU2Nyb2xsXG4gKiAgRGVzY3JpcHRpb246IEF1dG8tc2Nyb2xsIHBsdWdpbiBmb3IgdXNlIHdpdGggUmlzZSBWaXNpb24gV2lkZ2V0c1xuICogIEF1dGhvcjogQGRvbm5hcGVwXG4gKiAgTGljZW5zZTogTUlUXG4gKi9cblxuOyhmdW5jdGlvbiAoJCwgd2luZG93LCBkb2N1bWVudCwgdW5kZWZpbmVkKSB7XG5cdFwidXNlIHN0cmljdFwiO1xuXG5cdHZhciBwbHVnaW5OYW1lID0gXCJhdXRvU2Nyb2xsXCIsXG5cdFx0ZGVmYXVsdHMgPSB7XG5cdFx0XHRieTogXCJjb250aW51b3VzXCIsXG5cdFx0XHRzcGVlZDogXCJtZWRpdW1cIixcblx0XHRcdHBhdXNlOiA1XG5cdFx0fSxcblx0XHRpc0xvYWRpbmcgPSB0cnVlLFxuXHRcdGRyYWdnYWJsZSA9IG51bGwsXG5cdFx0dHdlZW4gPSBudWxsLFxuXHRcdHJlc3VtZVR3ZWVuID0gbnVsbDtcblxuXHRmdW5jdGlvbiBQbHVnaW4oZWxlbWVudCwgb3B0aW9ucykge1xuXHRcdHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG5cdFx0dGhpcy5wYWdlID0gJChlbGVtZW50KS5maW5kKFwiLnBhZ2VcIik7XG5cdFx0dGhpcy5vcHRpb25zID0gJC5leHRlbmQoe30sIGRlZmF1bHRzLCBvcHRpb25zKTtcblx0XHR0aGlzLl9kZWZhdWx0cyA9IGRlZmF1bHRzO1xuXHRcdHRoaXMuX25hbWUgPSBwbHVnaW5OYW1lO1xuXHRcdHRoaXMuaW5pdCgpO1xuXHR9XG5cblx0UGx1Z2luLnByb3RvdHlwZSA9IHtcblx0XHRpbml0OiBmdW5jdGlvbiAoKSB7XG5cdFx0XHR2YXIgc3BlZWQsIGR1cmF0aW9uO1xuXHRcdFx0dmFyIHNlbGYgPSB0aGlzO1xuXHRcdFx0dmFyIGNhbGN1bGF0ZVByb2dyZXNzID0gbnVsbDtcblx0XHRcdHZhciBzY3JvbGxDb21wbGV0ZSA9IG51bGw7XG5cdFx0XHR2YXIgcGFnZUNvbXBsZXRlID0gbnVsbDtcblx0XHRcdHZhciBlbGVtZW50SGVpZ2h0ID0gJCh0aGlzLmVsZW1lbnQpLm91dGVySGVpZ2h0KHRydWUpO1xuXHRcdFx0dmFyIHBhdXNlSGVpZ2h0ID0gZWxlbWVudEhlaWdodDtcblx0XHRcdHZhciBtYXggPSB0aGlzLmVsZW1lbnQuc2Nyb2xsSGVpZ2h0IC0gdGhpcy5lbGVtZW50Lm9mZnNldEhlaWdodDtcblxuXHRcdFx0aWYgKHRoaXMuY2FuU2Nyb2xsKCkpIHtcblx0XHRcdFx0Ly8gU2V0IHNjcm9sbCBzcGVlZC5cblx0XHRcdFx0aWYgKHRoaXMub3B0aW9ucy5ieSA9PT0gXCJwYWdlXCIpIHtcblx0XHRcdFx0XHRpZiAodGhpcy5vcHRpb25zLnNwZWVkID09PSBcImZhc3Rlc3RcIikge1xuXHRcdFx0XHRcdFx0c3BlZWQgPSAwLjQ7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2UgaWYgKHRoaXMub3B0aW9ucy5zcGVlZCA9PT0gXCJmYXN0XCIpIHtcblx0XHRcdFx0XHRcdHNwZWVkID0gMC44O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlIGlmICh0aGlzLm9wdGlvbnMuc3BlZWQgPT09IFwibWVkaXVtXCIpIHtcblx0XHRcdFx0XHRcdHNwZWVkID0gMS4yO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlIGlmICh0aGlzLm9wdGlvbnMuc3BlZWQgPT09IFwic2xvd1wiKSB7XG5cdFx0XHRcdFx0XHRzcGVlZCA9IDEuNjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWxzZSB7XG5cdFx0XHRcdFx0XHRzcGVlZCA9IDI7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0ZHVyYXRpb24gPSB0aGlzLnBhZ2Uub3V0ZXJIZWlnaHQodHJ1ZSkgL1xuXHRcdFx0XHRcdFx0JCh0aGlzLmVsZW1lbnQpLm91dGVySGVpZ2h0KHRydWUpICogc3BlZWQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZSB7XHQvLyBDb250aW51b3VzIG9yIGJ5IHJvd1xuXHRcdFx0XHRcdGlmICh0aGlzLm9wdGlvbnMuc3BlZWQgPT09IFwiZmFzdGVzdFwiKSB7XG5cdFx0XHRcdFx0XHRzcGVlZCA9IDYwO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlIGlmICh0aGlzLm9wdGlvbnMuc3BlZWQgPT09IFwiZmFzdFwiKSB7XG5cdFx0XHRcdFx0XHRzcGVlZCA9IDUwO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlIGlmICh0aGlzLm9wdGlvbnMuc3BlZWQgPT09IFwibWVkaXVtXCIpIHtcblx0XHRcdFx0XHRcdHNwZWVkID0gNDA7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2UgaWYgKHRoaXMub3B0aW9ucy5zcGVlZCA9PT0gXCJzbG93XCIpIHtcblx0XHRcdFx0XHRcdHNwZWVkID0gMzA7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0c3BlZWQgPSAyMDtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRkdXJhdGlvbiA9IE1hdGguYWJzKCh0aGlzLnBhZ2Uub3V0ZXJIZWlnaHQodHJ1ZSkgLVxuXHRcdFx0XHRcdFx0JCh0aGlzLmVsZW1lbnQpLm91dGVySGVpZ2h0KHRydWUpKSAvIHNwZWVkKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdERyYWdnYWJsZS5jcmVhdGUodGhpcy5lbGVtZW50LCB7XG5cdFx0XHRcdFx0dHlwZTogXCJzY3JvbGxUb3BcIixcblx0XHRcdFx0XHR0aHJvd1Byb3BzOiB0cnVlLFxuXHRcdFx0XHRcdGVkZ2VSZXNpc3RhbmNlOiAwLjc1LFxuXHRcdFx0XHRcdG9uUHJlc3M6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0dHdlZW4ucGF1c2UoKTtcblxuXHRcdFx0XHRcdFx0VHdlZW5MaXRlLmtpbGxEZWxheWVkQ2FsbHNUbyhjYWxjdWxhdGVQcm9ncmVzcyk7XG5cdFx0XHRcdFx0XHRUd2VlbkxpdGUua2lsbERlbGF5ZWRDYWxsc1RvKHNjcm9sbENvbXBsZXRlKTtcblx0XHRcdFx0XHRcdFR3ZWVuTGl0ZS5raWxsRGVsYXllZENhbGxzVG8ocmVzdW1lVHdlZW4pO1xuXHRcdFx0XHRcdFx0Ly8gT25seSB1c2VkIHdoZW4gc2Nyb2xsaW5nIGJ5IHBhZ2UuXG5cdFx0XHRcdFx0XHRUd2VlbkxpdGUua2lsbERlbGF5ZWRDYWxsc1RvKHBhZ2VDb21wbGV0ZSk7XG5cdFx0XHRcdFx0fSxcblx0XHRcdFx0XHRvblJlbGVhc2U6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0aWYgKHNlbGYub3B0aW9ucy5ieSAhPT0gXCJub25lXCIpIHtcblx0XHRcdFx0XHRcdFx0LyogRmlndXJlIG91dCB3aGF0IHRoZSBuZXcgc2Nyb2xsIHBvc2l0aW9uIGlzIGFuZFxuXHRcdFx0XHRcdFx0XHQgdHJhbnNsYXRlIHRoYXQgaW50byB0aGUgcHJvZ3Jlc3Mgb2YgdGhlIHR3ZWVuICgwLTEpXG5cdFx0XHRcdFx0XHRcdCBzbyB0aGF0IHdlIGNhbiBjYWxpYnJhdGUgaXQ7IG90aGVyd2lzZSwgaXQnZCBqdW1wXG5cdFx0XHRcdFx0XHRcdCBiYWNrIHRvIHdoZXJlIGl0IHBhdXNlZCB3aGVuIHdlIHJlc3VtZSgpLiAqL1xuXHRcdFx0XHRcdFx0XHRUd2VlbkxpdGUuZGVsYXllZENhbGwoc2VsZi5vcHRpb25zLnBhdXNlLFxuXHRcdFx0XHRcdFx0XHRcdGNhbGN1bGF0ZVByb2dyZXNzID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBTZXQgcGF1c2VIZWlnaHQgdG8gbmV3IHZhbHVlLlxuXHRcdFx0XHRcdFx0XHRcdFx0cGF1c2VIZWlnaHQgPSAkKHNlbGYuZWxlbWVudCkuc2Nyb2xsVG9wKCkgK1xuXHRcdFx0XHRcdFx0XHRcdFx0ZWxlbWVudEhlaWdodDtcblxuXHRcdFx0XHRcdFx0XHRcdFx0dHdlZW4ucHJvZ3Jlc3MoJChzZWxmLmVsZW1lbnQpLnNjcm9sbFRvcCgpIC8gbWF4KVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQucGxheSgpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdGRyYWdnYWJsZSA9IERyYWdnYWJsZS5nZXQodGhpcy5lbGVtZW50KTtcblxuXHRcdFx0XHR0d2VlbiA9IFR3ZWVuTGl0ZS50byhkcmFnZ2FibGUuc2Nyb2xsUHJveHksIGR1cmF0aW9uLCB7XG5cdFx0XHRcdFx0c2Nyb2xsVG9wOiBtYXgsXG5cdFx0XHRcdFx0ZWFzZTogTGluZWFyLmVhc2VOb25lLFxuXHRcdFx0XHRcdGRlbGF5OiB0aGlzLm9wdGlvbnMucGF1c2UsXG5cdFx0XHRcdFx0cGF1c2VkOiB0cnVlLFxuXHRcdFx0XHRcdG9uVXBkYXRlOiAodGhpcy5vcHRpb25zLmJ5ID09PSBcInBhZ2VcIiA/IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdFx0aWYgKE1hdGguYWJzKGRyYWdnYWJsZS5zY3JvbGxQcm94eS50b3AoKSkgPj0gcGF1c2VIZWlnaHQpIHtcblx0XHRcdFx0XHRcdFx0dHdlZW4ucGF1c2UoKTtcblxuXHRcdFx0XHRcdFx0XHQvLyBOZXh0IGhlaWdodCBhdCB3aGljaCB0byBwYXVzZSBzY3JvbGxpbmcuXG5cdFx0XHRcdFx0XHRcdHBhdXNlSGVpZ2h0ICs9IGVsZW1lbnRIZWlnaHQ7XG5cblx0XHRcdFx0XHRcdFx0VHdlZW5MaXRlLmRlbGF5ZWRDYWxsKHNlbGYub3B0aW9ucy5wYXVzZSxcblx0XHRcdFx0XHRcdFx0XHRwYWdlQ29tcGxldGUgPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHR3ZWVuLnJlc3VtZSgpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IDogdW5kZWZpbmVkKSxcblx0XHRcdFx0XHRvbkNvbXBsZXRlOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRcdFR3ZWVuTGl0ZS5kZWxheWVkQ2FsbChzZWxmLm9wdGlvbnMucGF1c2UsXG5cdFx0XHRcdFx0XHRcdHNjcm9sbENvbXBsZXRlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0VHdlZW5MaXRlLnRvKHNlbGYucGFnZSwgMSwge1xuXHRcdFx0XHRcdFx0XHRcdFx0YXV0b0FscGhhOiAwLFxuXHRcdFx0XHRcdFx0XHRcdFx0b25Db21wbGV0ZTogZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHR3ZWVuLnNlZWsoMCkucGF1c2UoKTtcblxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoc2VsZi5vcHRpb25zLmJ5ID09PSBcInBhZ2VcIikge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHBhdXNlSGVpZ2h0ID0gZWxlbWVudEhlaWdodDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCQoc2VsZi5lbGVtZW50KS50cmlnZ2VyKFwiZG9uZVwiKTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXG5cdFx0XHRcdC8vIEhpZGUgc2Nyb2xsYmFyLlxuXHRcdFx0XHRUd2VlbkxpdGUuc2V0KHRoaXMuZWxlbWVudCwgeyBvdmVyZmxvd1k6IFwiaGlkZGVuXCIgfSk7XG5cdFx0XHR9XG5cdFx0fSxcblx0XHQvLyBDaGVjayBpZiBjb250ZW50IGlzIGxhcmdlciB0aGFuIHZpZXdhYmxlIGFyZWEgYW5kIGlmIHRoZSBzY3JvbGwgc2V0dGluZ3MgaXMgc2V0IHRvIGFjdHVhbGx5IHNjcm9sbC5cblx0XHRjYW5TY3JvbGw6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuIHRoaXMub3B0aW9ucyAmJiAodGhpcy5wYWdlLmhlaWdodCgpID4gJCh0aGlzLmVsZW1lbnQpLmhlaWdodCgpKTtcblx0XHR9XG5cdH07XG5cblx0UGx1Z2luLnByb3RvdHlwZS5wbGF5ID0gZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuY2FuU2Nyb2xsKCkgJiYgdGhpcy5vcHRpb25zLmJ5ICE9PSBcIm5vbmVcIikge1xuXHRcdFx0aWYgKHR3ZWVuKSB7XG5cdFx0XHRcdGlmIChpc0xvYWRpbmcpIHtcblx0XHRcdFx0XHR0d2Vlbi5wbGF5KCk7XG5cdFx0XHRcdFx0aXNMb2FkaW5nID0gZmFsc2U7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZSB7XG5cdFx0XHRcdFx0VHdlZW5MaXRlLnRvKHRoaXMucGFnZSwgMSwge2F1dG9BbHBoYTogMX0pO1xuXHRcdFx0XHRcdFR3ZWVuTGl0ZS5kZWxheWVkQ2FsbCh0aGlzLm9wdGlvbnMucGF1c2UsXG5cdFx0XHRcdFx0XHRcdHJlc3VtZVR3ZWVuID0gZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0XHR0d2Vlbi5wbGF5KCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fTtcblxuXHRQbHVnaW4ucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHR3ZWVuKSB7XG5cdFx0XHR0d2Vlbi5wYXVzZSgpO1xuXHRcdH1cblx0fTtcblxuXHRQbHVnaW4ucHJvdG90eXBlLnN0b3AgPSBmdW5jdGlvbigpIHtcblx0XHRpZiAodHdlZW4pIHtcblx0XHRcdHR3ZWVuLmtpbGwoKTtcblx0XHR9XG5cblx0XHR0aGlzLmVsZW1lbnQgPSBudWxsO1xuXHRcdHRoaXMucGFnZSA9IG51bGw7XG5cdH07XG5cblx0Ly8gQSBsaWdodHdlaWdodCBwbHVnaW4gd3JhcHBlciBhcm91bmQgdGhlIGNvbnN0cnVjdG9yIHRoYXQgcHJldmVudHNcblx0Ly8gbXVsdGlwbGUgaW5zdGFudGlhdGlvbnMuXG5cdCQuZm4uYXV0b1Njcm9sbCA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcblx0XHRyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKCEkLmRhdGEodGhpcywgXCJwbHVnaW5fXCIgKyBwbHVnaW5OYW1lKSkge1xuXHRcdFx0XHQkLmRhdGEodGhpcywgXCJwbHVnaW5fXCIgKyBwbHVnaW5OYW1lLCBuZXcgUGx1Z2luKHRoaXMsIG9wdGlvbnMpKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fTtcbn0pKGpRdWVyeSwgd2luZG93LCBkb2N1bWVudCk7XG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblxuUmlzZVZpc2lvbi5Db21tb24gPSBSaXNlVmlzaW9uLkNvbW1vbiB8fCB7fTtcblxuUmlzZVZpc2lvbi5Db21tb24uVXRpbGl0aWVzID0gKGZ1bmN0aW9uKCkge1xuXG4gIGZ1bmN0aW9uIGdldEZvbnRDc3NTdHlsZShjbGFzc05hbWUsIGZvbnRPYmopIHtcbiAgICB2YXIgZmFtaWx5ID0gXCJmb250LWZhbWlseTpcIiArIGZvbnRPYmouZm9udC5mYW1pbHkgKyBcIjsgXCI7XG4gICAgdmFyIGNvbG9yID0gXCJjb2xvcjogXCIgKyBmb250T2JqLmNvbG9yICsgXCI7IFwiO1xuICAgIHZhciBzaXplID0gXCJmb250LXNpemU6IFwiICsgZm9udE9iai5zaXplICsgXCJweDsgXCI7XG4gICAgdmFyIHdlaWdodCA9IFwiZm9udC13ZWlnaHQ6IFwiICsgKGZvbnRPYmouYm9sZCA/IFwiYm9sZFwiIDogXCJub3JtYWxcIikgKyBcIjsgXCI7XG4gICAgdmFyIGl0YWxpYyA9IFwiZm9udC1zdHlsZTogXCIgKyAoZm9udE9iai5pdGFsaWMgPyBcIml0YWxpY1wiIDogXCJub3JtYWxcIikgKyBcIjsgXCI7XG4gICAgdmFyIHVuZGVybGluZSA9IFwidGV4dC1kZWNvcmF0aW9uOiBcIiArIChmb250T2JqLnVuZGVybGluZSA/IFwidW5kZXJsaW5lXCIgOiBcIm5vbmVcIikgKyBcIjsgXCI7XG4gICAgdmFyIGhpZ2hsaWdodCA9IFwiYmFja2dyb3VuZC1jb2xvcjogXCIgKyBmb250T2JqLmhpZ2hsaWdodENvbG9yICsgXCI7IFwiO1xuXG4gICAgcmV0dXJuIFwiLlwiICsgY2xhc3NOYW1lICsgXCIge1wiICsgZmFtaWx5ICsgY29sb3IgKyBzaXplICsgd2VpZ2h0ICsgaXRhbGljICsgdW5kZXJsaW5lICsgaGlnaGxpZ2h0ICsgXCJ9XCI7XG4gIH1cblxuICBmdW5jdGlvbiBhZGRDU1NSdWxlcyhydWxlcykge1xuICAgIHZhciBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzdHlsZVwiKTtcblxuICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBydWxlcy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgc3R5bGUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUocnVsZXNbaV0pKTtcbiAgICB9XG5cbiAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlKTtcbiAgfVxuXG4gIC8qXG4gICAqIExvYWRzIEdvb2dsZSBvciBjdXN0b20gZm9udHMsIGlmIGFwcGxpY2FibGUsIGFuZCBpbmplY3RzIENTUyBzdHlsZXNcbiAgICogaW50byB0aGUgaGVhZCBvZiB0aGUgZG9jdW1lbnQuXG4gICAqXG4gICAqIEBwYXJhbSAgICBhcnJheSAgICBzZXR0aW5ncyAgICBBcnJheSBvZiBvYmplY3RzIHdpdGggdGhlIGZvbGxvd2luZyBmb3JtOlxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFt7XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImNsYXNzXCI6IFwiZGF0ZVwiLFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXCJmb250U2V0dGluZ1wiOiB7XG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9sZDogdHJ1ZSxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogXCJibGFja1wiLFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbnQ6IHtcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhbWlseTogXCJBa3JvbmltXCIsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb250OiBcIkFrcm9uaW1cIixcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IFwiVmVyZGFuYVwiLFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJnb29nbGVcIixcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogXCJodHRwOi8vY3VzdG9tLWZvbnQtdXJsXCJcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodENvbG9yOiBcInRyYW5zcGFyZW50XCIsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRhbGljOiBmYWxzZSxcbiAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBcIjIwXCIsXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5kZXJsaW5lOiBmYWxzZVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1dXG4gICAqXG4gICAqICAgICAgICAgICBvYmplY3QgICBjb250ZW50RG9jICAgIERvY3VtZW50IG9iamVjdCBpbnRvIHdoaWNoIHRvIGluamVjdCBzdHlsZXNcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5kIGxvYWQgZm9udHMgKG9wdGlvbmFsKS5cbiAgICovXG4gIGZ1bmN0aW9uIGxvYWRGb250cyhzZXR0aW5ncywgY29udGVudERvYykge1xuICAgIHNldHRpbmdzLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgICAgaWYgKGl0ZW0uY2xhc3MgJiYgaXRlbS5mb250U2V0dGluZykge1xuICAgICAgICBhZGRDU1NSdWxlcyhbIGdldEZvbnRDc3NTdHlsZShpdGVtLmNsYXNzLCBpdGVtLmZvbnRTZXR0aW5nKSBdKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGl0ZW0uZm9udFNldHRpbmcuZm9udC50eXBlKSB7XG4gICAgICAgIGlmIChpdGVtLmZvbnRTZXR0aW5nLmZvbnQudHlwZSA9PT0gXCJjdXN0b21cIiAmJiBpdGVtLmZvbnRTZXR0aW5nLmZvbnQuZmFtaWx5ICYmXG4gICAgICAgICAgaXRlbS5mb250U2V0dGluZy5mb250LnVybCkge1xuICAgICAgICAgIGxvYWRDdXN0b21Gb250KGl0ZW0uZm9udFNldHRpbmcuZm9udC5mYW1pbHksIGl0ZW0uZm9udFNldHRpbmcuZm9udC51cmwsXG4gICAgICAgICAgICBjb250ZW50RG9jKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmIChpdGVtLmZvbnRTZXR0aW5nLmZvbnQudHlwZSA9PT0gXCJnb29nbGVcIiAmJiBpdGVtLmZvbnRTZXR0aW5nLmZvbnQuZmFtaWx5KSB7XG4gICAgICAgICAgbG9hZEdvb2dsZUZvbnQoaXRlbS5mb250U2V0dGluZy5mb250LmZhbWlseSwgY29udGVudERvYyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGxvYWRDdXN0b21Gb250KGZhbWlseSwgdXJsLCBjb250ZW50RG9jKSB7XG4gICAgdmFyIHNoZWV0ID0gbnVsbDtcbiAgICB2YXIgcnVsZSA9IFwiZm9udC1mYW1pbHk6IFwiICsgZmFtaWx5ICsgXCI7IFwiICsgXCJzcmM6IHVybCgnXCIgKyB1cmwgKyBcIicpO1wiO1xuXG4gICAgY29udGVudERvYyA9IGNvbnRlbnREb2MgfHwgZG9jdW1lbnQ7XG5cbiAgICBzaGVldCA9IGNvbnRlbnREb2Muc3R5bGVTaGVldHNbMF07XG5cbiAgICBpZiAoc2hlZXQgIT09IG51bGwpIHtcbiAgICAgIHNoZWV0LmFkZFJ1bGUoXCJAZm9udC1mYWNlXCIsIHJ1bGUpO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGxvYWRHb29nbGVGb250KGZhbWlseSwgY29udGVudERvYykge1xuICAgIHZhciBzdHlsZXNoZWV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpbmtcIik7XG5cbiAgICBjb250ZW50RG9jID0gY29udGVudERvYyB8fCBkb2N1bWVudDtcblxuICAgIHN0eWxlc2hlZXQuc2V0QXR0cmlidXRlKFwicmVsXCIsIFwic3R5bGVzaGVldFwiKTtcbiAgICBzdHlsZXNoZWV0LnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJ0ZXh0L2Nzc1wiKTtcbiAgICBzdHlsZXNoZWV0LnNldEF0dHJpYnV0ZShcImhyZWZcIiwgXCJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2Nzcz9mYW1pbHk9XCIgK1xuICAgICAgZmFtaWx5KTtcblxuICAgIGlmIChzdHlsZXNoZWV0ICE9PSBudWxsKSB7XG4gICAgICBjb250ZW50RG9jLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaGVhZFwiKVswXS5hcHBlbmRDaGlsZChzdHlsZXNoZWV0KTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBwcmVsb2FkSW1hZ2VzKHVybHMpIHtcbiAgICB2YXIgbGVuZ3RoID0gdXJscy5sZW5ndGgsXG4gICAgICBpbWFnZXMgPSBbXTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIGltYWdlc1tpXSA9IG5ldyBJbWFnZSgpO1xuICAgICAgaW1hZ2VzW2ldLnNyYyA9IHVybHNbaV07XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBnZXRGb250Q3NzU3R5bGU6ICBnZXRGb250Q3NzU3R5bGUsXG4gICAgYWRkQ1NTUnVsZXM6ICAgICAgYWRkQ1NTUnVsZXMsXG4gICAgbG9hZEZvbnRzOiAgICAgICAgbG9hZEZvbnRzLFxuICAgIGxvYWRDdXN0b21Gb250OiAgIGxvYWRDdXN0b21Gb250LFxuICAgIGxvYWRHb29nbGVGb250OiAgIGxvYWRHb29nbGVGb250LFxuICAgIHByZWxvYWRJbWFnZXM6ICAgIHByZWxvYWRJbWFnZXNcbiAgfTtcbn0pKCk7XG5cbi8qIGpzaGludCBpZ25vcmU6c3RhcnQgKi9cbnZhciBfZ2FxID0gX2dhcSB8fCBbXTtcblxuX2dhcS5wdXNoKFtcIl9zZXRBY2NvdW50XCIsIFwiVUEtNTcwOTIxNTktMTNcIl0pO1xuX2dhcS5wdXNoKFtcIl90cmFja1BhZ2V2aWV3XCJdKTtcblxuKGZ1bmN0aW9uKCkge1xuICB2YXIgZ2EgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpOyBnYS50eXBlID0gXCJ0ZXh0L2phdmFzY3JpcHRcIjsgZ2EuYXN5bmMgPSB0cnVlO1xuICBnYS5zcmMgPSAoXCJodHRwczpcIiA9PSBkb2N1bWVudC5sb2NhdGlvbi5wcm90b2NvbCA/IFwiaHR0cHM6Ly9zc2xcIiA6IFwiaHR0cDovL3d3d1wiKSArIFwiLmdvb2dsZS1hbmFseXRpY3MuY29tL2dhLmpzXCI7XG4gIHZhciBzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIilbMF07IHMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZ2EsIHMpO1xufSkoKTtcbi8qIGpzaGludCBpZ25vcmU6ZW5kICovXG5cbi8qIGdsb2JhbCBnYWRnZXRzOmZhbHNlICovXG5cbnZhciBSaXNlVmlzaW9uID0gUmlzZVZpc2lvbiB8fCB7fTtcblJpc2VWaXNpb24uVGV4dCA9IHt9O1xuXG5SaXNlVmlzaW9uLlRleHQgPSAoZnVuY3Rpb24oZ2FkZ2V0cykge1xuICBcInVzZSBzdHJpY3RcIjtcblxuICB2YXIgcHJlZnMgPSBuZXcgZ2FkZ2V0cy5QcmVmcygpO1xuICB2YXIgdXRpbHMgPSBSaXNlVmlzaW9uLkNvbW1vbi5VdGlsaXRpZXM7XG5cbiAgLypcbiAgICogIFByaXZhdGUgTWV0aG9kc1xuICAgKi9cbiAgZnVuY3Rpb24gcmVhZHkoKSB7XG4gICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzZXZlbnRfcmVhZHlcIiwgbnVsbCwgcHJlZnMuZ2V0U3RyaW5nKFwiaWRcIiksIHRydWUsXG4gICAgICB0cnVlLCB0cnVlLCB0cnVlLCB0cnVlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGRvbmUoKSB7XG4gICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzZXZlbnRfZG9uZVwiLCBudWxsLCBwcmVmcy5nZXRTdHJpbmcoXCJpZFwiKSk7XG4gIH1cblxuICAvKlxuICAgKiAgUHVibGljIE1ldGhvZHNcbiAgICovXG4gIGZ1bmN0aW9uIGdldEFkZGl0aW9uYWxQYXJhbXMobmFtZSwgdmFsdWUpIHtcbiAgICBpZiAobmFtZSA9PT0gXCJhZGRpdGlvbmFsUGFyYW1zXCIgJiYgdmFsdWUpIHtcbiAgICAgIHZhciBwYXJhbXMgPSBKU09OLnBhcnNlKHZhbHVlKTtcbiAgICAgIHZhciBkYXRhID0gcGFyYW1zLmRhdGE7XG4gICAgICB2YXIgcnVsZXMgPSBbXTtcblxuICAgICAgLy8gU2V0IGhlaWdodCBvZiBjb250YWluZXIgdG8gdGhhdCBvZiBQbGFjZWhvbGRlciBzbyB0aGF0IHNjcm9sbGluZyB3b3Jrcy5cbiAgICAgICQoXCIjY29udGFpbmVyXCIpLmhlaWdodChwcmVmcy5nZXRJbnQoXCJyc0hcIikpXG4gICAgICAgIC5jc3MoXCJiYWNrZ3JvdW5kLWNvbG9yXCIsIHBhcmFtcy5iYWNrZ3JvdW5kIHx8IFwidHJhbnNwYXJlbnRcIik7XG4gICAgICAkKFwiLnBhZ2VcIikud2lkdGgocHJlZnMuZ2V0SW50KFwicnNXXCIpKS5odG1sKGRhdGEpO1xuXG4gICAgICAkLmVhY2goJChcIjxkaXYvPlwiKS5odG1sKGRhdGEpLmZpbmQoXCJzcGFuXCIpLmFkZEJhY2soKSwgZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzdGFuZGFyZEZvbnQgPSAkKHRoaXMpLmF0dHIoXCJkYXRhLXN0YW5kYXJkLWZvbnRcIik7XG4gICAgICAgIHZhciBnb29nbGVGb250ID0gJCh0aGlzKS5hdHRyKFwiZGF0YS1nb29nbGUtZm9udFwiKTtcbiAgICAgICAgdmFyIGN1c3RvbUZvbnQgPSAkKHRoaXMpLmF0dHIoXCJkYXRhLWN1c3RvbS1mb250XCIpO1xuICAgICAgICB2YXIgdGV4dENvbG9yID0gXCJcIiwgaGlnaGxpZ2h0Q29sb3IgPSBcIlwiO1xuICAgICAgICB2YXIgY2xhc3NlcyA9IFtdO1xuXG4gICAgICAgIC8vIEFkZCBDU1MgZm9yIHN0YW5kYXJkIGZvbnRzLlxuICAgICAgICBpZiAoc3RhbmRhcmRGb250KSB7XG4gICAgICAgICAgcnVsZXMucHVzaChjcmVhdGVGb250UnVsZShzdGFuZGFyZEZvbnQpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIExvYWQgR29vZ2xlIGZvbnQuXG4gICAgICAgIGlmIChnb29nbGVGb250KSB7XG4gICAgICAgICAgdXRpbHMubG9hZEdvb2dsZUZvbnQoZ29vZ2xlRm9udCk7XG5cbiAgICAgICAgICAvLyBBZGQgQ1NTIGZvciB0aGUgR29vZ2xlIGZvbnQgcGx1cyBhIGZhbGxiYWNrLlxuICAgICAgICAgIHJ1bGVzLnB1c2goY3JlYXRlRm9udFJ1bGUoZ29vZ2xlRm9udCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTG9hZCBjdXN0b20gZm9udC5cbiAgICAgICAgaWYgKGN1c3RvbUZvbnQpIHtcbiAgICAgICAgICB1dGlscy5sb2FkQ3VzdG9tRm9udChjdXN0b21Gb250LCAkKHRoaXMpLmF0dHIoXCJkYXRhLWN1c3RvbS1mb250LXVybFwiKSk7XG5cbiAgICAgICAgICAvLyBBZGQgQ1NTIGZvciB0aGUgY3VzdG9tIGZvbnQgcGx1cyBhIGZhbGxiYWNrLlxuICAgICAgICAgIHJ1bGVzLnB1c2goY3JlYXRlRm9udFJ1bGUoY3VzdG9tRm9udCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2V0IHRleHQgYW5kIGhpZ2hsaWdodCBjb2xvdXJzLlxuICAgICAgICBjbGFzc2VzID0gdGhpcy5jbGFzc05hbWUuc3BsaXQoXCIgXCIpO1xuICAgICAgICB0ZXh0Q29sb3IgPSAkKHRoaXMpLmF0dHIoXCJkYXRhLXRleHQtY29sb3JcIik7XG4gICAgICAgIGhpZ2hsaWdodENvbG9yID0gJCh0aGlzKS5hdHRyKFwiZGF0YS1oaWdobGlnaHQtY29sb3JcIik7XG5cbiAgICAgICAgLyogQ2hlY2sgaWYgYW55IG9mIHRoZSBjbGFzc2VzIHN0YXJ0IHdpdGggJ3d5c2l3eWctdGV4dC1jb2xvcicgb3JcbiAgICAgICAgICAgJ3d5c2l3eWctaGlnaGxpZ2h0LWNvbG9yJy4gKi9cbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGNsYXNzZXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZiAoY2xhc3Nlc1tpXS5pbmRleE9mKFwid3lzaXd5Zy10ZXh0LWNvbG9yXCIpID09PSAwKSB7XG4gICAgICAgICAgICBydWxlcy5wdXNoKFwiLlwiICsgY2xhc3Nlc1tpXSArIFwiIHsgY29sb3I6IFwiICsgdGV4dENvbG9yICsgXCI7IH1cIik7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsc2UgaWYgKGNsYXNzZXNbaV0uaW5kZXhPZihcInd5c2l3eWctaGlnaGxpZ2h0LWNvbG9yXCIpID09PSAwKSB7XG4gICAgICAgICAgICBydWxlcy5wdXNoKFwiLlwiICsgY2xhc3Nlc1tpXSArIFwiIHsgYmFja2dyb3VuZC1jb2xvcjogXCIgK1xuICAgICAgICAgICAgICBoaWdobGlnaHRDb2xvciArIFwiOyB9XCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHV0aWxzLmFkZENTU1J1bGVzKHJ1bGVzKTtcblxuICAgICAgJChcIiNjb250YWluZXJcIikuYXV0b1Njcm9sbChwYXJhbXMuc2Nyb2xsKVxuICAgICAgLm9uKFwiZG9uZVwiLCBmdW5jdGlvbigpIHtcbiAgICAgICAgZG9uZSgpO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmVhZHkoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNyZWF0ZUZvbnRSdWxlKGZvbnQpIHtcbiAgICByZXR1cm4gXCIud3lzaXd5Zy1mb250LWZhbWlseS1cIiArIGZvbnQucmVwbGFjZSgvIC9nLCBcIi1cIikudG9Mb3dlckNhc2UoKSArXG4gICAgICBcIiB7IGZvbnQtZmFtaWx5OiAnXCIgKyBmb250ICsgXCInLCBzZXJpZjsgfVwiO1xuICB9XG5cbiAgZnVuY3Rpb24gcGxheSgpIHtcbiAgICAkKFwiI2NvbnRhaW5lclwiKS5kYXRhKFwicGx1Z2luX2F1dG9TY3JvbGxcIikucGxheSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgJChcIiNjb250YWluZXJcIikuZGF0YShcInBsdWdpbl9hdXRvU2Nyb2xsXCIpLnBhdXNlKCk7XG4gIH1cblxuICBmdW5jdGlvbiBzdG9wKCkge1xuICAgIHBhdXNlKCk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGdldEFkZGl0aW9uYWxQYXJhbXM6IGdldEFkZGl0aW9uYWxQYXJhbXMsXG4gICAgcGxheSAgICAgICAgICAgICAgIDogcGxheSxcbiAgICBwYXVzZSAgICAgICAgICAgICAgOiBwYXVzZSxcbiAgICBzdG9wICAgICAgICAgICAgICAgOiBzdG9wXG4gIH07XG59KShnYWRnZXRzKTtcblxuLyogZ2xvYmFsIFJpc2VWaXNpb24sIGdhZGdldHMgKi9cblxuKGZ1bmN0aW9uICh3aW5kb3csIGdhZGdldHMpIHtcbiAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgdmFyIHByZWZzID0gbmV3IGdhZGdldHMuUHJlZnMoKTtcbiAgdmFyIGlkID0gcHJlZnMuZ2V0U3RyaW5nKFwiaWRcIik7XG5cbiAgZnVuY3Rpb24gcGxheSgpIHtcbiAgICBSaXNlVmlzaW9uLlRleHQucGxheSgpO1xuICB9XG5cbiAgZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgUmlzZVZpc2lvbi5UZXh0LnBhdXNlKCk7XG4gIH1cblxuICBmdW5jdGlvbiBzdG9wKCkge1xuICAgIFJpc2VWaXNpb24uVGV4dC5zdG9wKCk7XG4gIH1cblxuICAvLyBHZXQgYWRkaXRpb25hbCBwYXJhbWV0ZXJzLlxuICBpZiAoaWQpIHtcbiAgICBnYWRnZXRzLnJwYy5yZWdpc3RlcihcInJzY21kX3BsYXlfXCIgKyBpZCwgcGxheSk7XG4gICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc2NtZF9wYXVzZV9cIiArIGlkLCBwYXVzZSk7XG4gICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc2NtZF9zdG9wX1wiICsgaWQsIHN0b3ApO1xuXG4gICAgZ2FkZ2V0cy5ycGMucmVnaXN0ZXIoXCJyc3BhcmFtX3NldF9cIiArIGlkLCBSaXNlVmlzaW9uLlRleHQuZ2V0QWRkaXRpb25hbFBhcmFtcyk7XG4gICAgZ2FkZ2V0cy5ycGMuY2FsbChcIlwiLCBcInJzcGFyYW1fZ2V0XCIsIG51bGwsIGlkLCBcImFkZGl0aW9uYWxQYXJhbXNcIik7XG4gIH1cblxuICB3aW5kb3cub25jb250ZXh0bWVudSA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG59KSh3aW5kb3csIGdhZGdldHMpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9